<!DOCTYPE html>
<html lang="es">
<head>
  <!-- =========================================
    BLOQUE: Inclusi칩n de librer칤as y estilos
    Explicaci칩n: Carga Chart.js para gr치ficas, estilos modernos y el favicon de la marca.
  ========================================= -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script type="module" src="../js/analytics-charts.js" defer></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-K88FPQS90X"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-K88FPQS90X');
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel de Administraci칩n</title>
  <link rel="icon" type="image/png" href="../fotos/favicon.ico">
  <link rel="stylesheet" href="../css/admin-glass.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
  <div class="dashboard-container">
    <aside class="sidebar" id="sidebar">
      <div class="logo">
        <img src="../fotos/nuevo-logo-Rm-300x195.webp" alt="Renacer Mascotas">
      </div>
      <nav class="sidebar-nav">
        <ul>
          <li><a href="#" class="tab-btn active" data-tab="analytics"><i class="fa-solid fa-chart-line"></i> <span>Anal칤tica</span></a></li>
          <li><a href="#" class="tab-btn" data-tab="blog"><i class="fa-solid fa-newspaper"></i> <span>Blog</span></a></li>
          <li><a href="#" class="tab-btn" data-tab="testimonios"><i class="fa-solid fa-quote-left"></i> <span>Testimonios</span></a></li>
          <li><a href="#" class="tab-btn" data-tab="galeria"><i class="fa-solid fa-images"></i> <span>Galer칤a</span></a></li>
          <li><a href="#" class="tab-btn" data-tab="aliados"><i class="fa-solid fa-handshake"></i> <span>Aliados</span></a></li>
          <li><a href="#" class="tab-btn" data-tab="convenios"><i class="fa-solid fa-building"></i> <span>Convenios</span></a></li>
        </ul>
      </nav>
      <div class="sidebar-toggle" id="sidebar-toggle-btn">
        <i class="fa-solid fa-chevron-left"></i>
      </div>
    </aside>
    <main class="main-content">
      <header class="dashboard-header">
        <button class="mobile-nav-toggle" id="mobile-nav-toggle-btn"><i class="fa-solid fa-bars"></i></button>
        <div>
          <h1>Panel de Administraci칩n</h1>
          <p>Bienvenido al centro de control de Renacer Mascotas.</p>
        </div>
        <div class="user-profile">
          <div class="theme-toggle" id="theme-toggle-btn">
            <i class="fa-solid fa-moon"></i>
            <i class="fa-solid fa-sun"></i>
          </div>
          <div class="avatar"></div>
          <i class="fa-solid fa-right-from-bracket" id="logout-btn"></i>
        </div>
      </header>
      <div class="widgets-grid">
        <section id="tab-analytics" class="tab-section active">
          <h3><i class="fa-solid fa-chart-line"></i> Anal칤tica Web</h3>
          <div id="analytics-summary" class="analytics-summary">
            <div class="widget">
              <div class="summary-icon"><i class="fa-solid fa-users"></i></div>
              <div class="summary-title">Visitas</div>
              <div id="analytics-visits" class="summary-value">-</div>
            </div>
            <div class="widget">
              <div class="summary-icon"><i class="fa-solid fa-clock"></i></div>
              <div class="summary-title">Tiempo promedio</div>
              <div id="analytics-avgtime" class="summary-value">-</div>
            </div>
            <div class="widget">
              <div class="summary-icon"><i class="fa-solid fa-globe"></i></div>
              <div class="summary-title">Zona m치s activa</div>
              <div id="analytics-topzone" class="summary-value">-</div>
            </div>
          </div>
          <div class="widget large-brain">
            <video src="../fotos/brain.mp4" autoplay loop muted playsinline>Tu navegador no soporta el elemento de video.</video>
          </div>
          <div id="widget-countries" class="widget">
            <h4><i class="fa-solid fa-earth-americas"></i> Distribuci칩n por pa칤s</h4>
            <canvas id="analytics-countries-chart"></canvas>
          </div>
          <div id="widget-visits" class="widget">
            <h4><i class="fa-solid fa-chart-area"></i> Visitas por d칤a</h4>
            <canvas id="analytics-visits-chart"></canvas>
          </div>
          <div class="analytics-disclaimer">* Los datos se actualizan autom치ticamente desde Google Analytics.</div>
        </section>
        <section id="tab-blog" class="tab-section">
          <h3><i class="fa-solid fa-newspaper"></i> Entradas de Blog</h3>
          <form id="blog-form" autocomplete="off">
              <input type="hidden" id="blog-post-id">
              <input type="text" id="blog-title" placeholder="T칤tulo del post" autocomplete="off" required>
              <div class="file-row">
                  <input type="file" id="blog-image-file" accept="image/*">
                  <input type="text" id="blog-image-url" placeholder="O pega la URL de una imagen" autocomplete="url">
              </div>
              <textarea id="blog-content" placeholder="Contenido del post..." rows="5" autocomplete="off" required></textarea>
              <div class="form-actions">
                <button type="submit" id="blog-submit-btn">Guardar Post</button>
                <button type="button" id="blog-cancel-btn" style="display:none;">Cancelar</button>
              </div>
          </form>
          <table id="blog-table">
              <thead><tr><th>T칤tulo</th><th>Imagen</th><th>Fecha</th><th>Acciones</th></tr></thead>
              <tbody><!-- Las filas se llenar치n con JS --></tbody>
          </table>
          <div id="blog-pagination" class="pagination-controls"></div>
        </section>
        <section id="tab-testimonios" class="tab-section">
          <h3><i class="fa-solid fa-quote-left"></i> Testimonios</h3>
          <form id="testimonial-form" autocomplete="off">
              <input type="hidden" id="testimonial-id">
              <input type="text" id="testimonial-author" placeholder="Autor del testimonio" autocomplete="name" required>
              <div class="file-row">
                <input type="file" id="testimonial-image-file" accept="image/*">
                <input type="text" id="testimonial-image-url" placeholder="O pega la URL de una imagen" autocomplete="url">
              </div>
              <textarea id="testimonial-text" placeholder="Texto del testimonio..." rows="3" autocomplete="off" required></textarea>
              <div class="form-actions">
                <button type="submit" id="testimonial-submit-btn">Guardar Testimonio</button>
                <button type="button" id="testimonial-cancel-btn" style="display:none;">Cancelar</button>
              </div>
          </form>
          <table id="testimonials-table">
              <thead><tr><th>Autor</th><th>Imagen</th><th>Testimonio</th><th>Acciones</th></tr></thead>
              <tbody><!-- Las filas se llenar치n con JS --></tbody>
          </table>
          <div id="testimonials-pagination" class="pagination-controls"></div>
        </section>
        <section id="tab-galeria" class="tab-section">
          <h3><i class="fa-solid fa-images"></i> Galer칤a</h3>
          <form id="gallery-form" autocomplete="off">
              <input type="hidden" id="gallery-id">
              <input type="file" id="gallery-image-file" accept="image/*" required>
              <input type="text" id="gallery-description" placeholder="Descripci칩n de la imagen" autocomplete="off">
              <button type="submit" id="gallery-submit-btn">A침adir a la Galer칤a</button>
              <button type="button" id="gallery-cancel-btn" style="display:none;">Cancelar</button>
          </form>
          <table id="gallery-table">
              <thead><tr><th>Imagen</th><th>Descripci칩n</th><th>Acciones</th></tr></thead>
              <tbody><!-- Las filas se llenar치n con JS --></tbody>
          </table>
          <div id="gallery-pagination" class="pagination-controls"></div>
        </section>
        <section id="tab-aliados" class="tab-section">
          <h3><i class="fa-solid fa-handshake"></i> Aliados</h3>
          
          <!-- Buscador de Aliados -->
          <div style="margin-bottom: 20px;">
            <input type="text" id="aliados-search" placeholder="游댌 Buscar por nombre de aliado..." autocomplete="off" style="width: 100%; padding: 12px 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
          </div>
          
          <form id="aliados-form" autocomplete="off">
              <input type="hidden" id="aliado-id">
              <input type="text" id="aliado-nombre" placeholder="Nombre del aliado" autocomplete="off" required>
              <input type="text" id="aliado-departamento" placeholder="Departamento (ej: Risaralda, Cundinamarca)" autocomplete="off" required>
              <input type="text" id="aliado-ciudad" placeholder="Ciudad (ej: Pereira, Dosquebradas)" autocomplete="off" required>
              <!-- Vista previa del logo actual -->
              <div id="aliado-current-logo" style="display:none; margin: 10px 0; padding: 15px; background: #f5f5f5; border-radius: 8px; text-align: center;">
                <p style="margin: 0 0 10px 0; font-weight: 600; color: #666;">Logo Actual:</p>
                <img id="aliado-logo-preview" src="" alt="Logo actual" style="max-width: 200px; max-height: 150px; object-fit: contain; border: 2px solid #ddd; border-radius: 5px; background: white; padding: 10px;">
                <p style="margin: 10px 0 0 0; font-size: 0.85em; color: #999;">Puedes mantener este logo o subir uno nuevo</p>
              </div>
              <div class="file-row">
                <input type="file" id="aliado-logo-file" accept="image/*" required>
                <input type="text" id="aliado-logo-url" placeholder="O pega la URL del logo" autocomplete="url">
              </div>
              <input type="url" id="aliado-website" placeholder="Sitio web (opcional)" autocomplete="url">
              <textarea id="aliado-descripcion" placeholder="Descripci칩n breve (opcional)" rows="2" autocomplete="off"></textarea>
              <div class="form-actions">
                <button type="submit" id="aliado-submit-btn">Guardar Aliado</button>
                <button type="button" id="aliado-cancel-btn" style="display:none;">Cancelar</button>
              </div>
          </form>
          <table id="aliados-table">
              <thead><tr><th>Logo</th><th>Nombre</th><th>Departamento</th><th>Ciudad</th><th>Acciones</th></tr></thead>
              <tbody><!-- Las filas se llenar치n con JS --></tbody>
          </table>
          <div id="aliados-pagination" class="pagination-controls"></div>
        </section>
        <section id="tab-convenios" class="tab-section">
          <h3><i class="fa-solid fa-hospital"></i> Convenios</h3>
          
          <!-- Buscador de Convenios -->
          <div style="margin-bottom: 20px;">
            <input type="text" id="convenios-search" placeholder="游댌 Buscar por nombre de convenio..." autocomplete="off" style="width: 100%; padding: 12px 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
          </div>
          
          <form id="convenios-form" autocomplete="off">
              <input type="hidden" id="convenio-id">
              <input type="text" id="convenio-nombre" placeholder="Nombre del convenio" autocomplete="off" required>
              <input type="text" id="convenio-departamento" placeholder="Departamento (ej: Risaralda, Quind칤o)" autocomplete="off" required>
              <input type="text" id="convenio-ciudad" placeholder="Ciudad (ej: Pereira, Armenia, Manizales)" autocomplete="off" required>
              <!-- Vista previa del logo actual -->
              <div id="convenio-current-logo" style="display:none; margin: 10px 0; padding: 15px; background: #f5f5f5; border-radius: 8px; text-align: center;">
                <p style="margin: 0 0 10px 0; font-weight: 600; color: #666;">Logo Actual:</p>
                <img id="convenio-logo-preview" src="" alt="Logo actual" style="max-width: 200px; max-height: 150px; object-fit: contain; border: 2px solid #ddd; border-radius: 5px; background: white; padding: 10px;">
                <p style="margin: 10px 0 0 0; font-size: 0.85em; color: #999;">Puedes mantener este logo o subir uno nuevo</p>
              </div>
              <div class="file-row">
                <input type="file" id="convenio-logo-file" accept="image/*" required>
                <input type="text" id="convenio-logo-url" placeholder="O pega la URL del logo" autocomplete="url">
              </div>
              <input type="text" id="convenio-direccion" placeholder="Direcci칩n (opcional)" autocomplete="off">
              <input type="tel" id="convenio-telefono" placeholder="Tel칠fono (opcional)" autocomplete="tel">
              <input type="text" id="convenio-horario" placeholder="Horario (ej: 24H, Lun-Vie 8am-6pm)" autocomplete="off">
              <textarea id="convenio-descripcion" placeholder="Descripci칩n o servicios (opcional)" rows="2" autocomplete="off"></textarea>
              <div class="form-actions">
                <button type="submit" id="convenio-submit-btn">Guardar Convenio</button>
                <button type="button" id="convenio-cancel-btn" style="display:none;">Cancelar</button>
              </div>
          </form>
          <table id="convenios-table">
              <thead><tr><th>Logo</th><th>Nombre</th><th>Departamento</th><th>Ciudad</th><th>Horario</th><th>Acciones</th></tr></thead>
              <tbody><!-- Las filas se llenar치n con JS --></tbody>
          </table>
          <div id="convenios-pagination" class="pagination-controls"></div>
        </section>
      </div>
    </main>
  </div>
  <script type="module" src="../js/admin-dashboard.js"></script>
  <script>
    // Script para la barra lateral colapsable (desktop)
    const toggleBtnDesktop = document.getElementById('sidebar-toggle-btn');
    const dashboardContainer = document.querySelector('.dashboard-container');

    if (toggleBtnDesktop && dashboardContainer) {
      toggleBtnDesktop.addEventListener('click', () => {
        dashboardContainer.classList.toggle('sidebar-collapsed');
      });
    }

    // Script para la barra lateral en m칩vil
    const mobileToggleBtn = document.getElementById('mobile-nav-toggle-btn');
    const sidebar = document.getElementById('sidebar');

    if (mobileToggleBtn && sidebar && dashboardContainer) {
      mobileToggleBtn.addEventListener('click', () => {
        dashboardContainer.classList.toggle('sidebar-mobile-open');
      });

      // Cerrar men칰 al hacer clic en un enlace o fuera de 칠l
      document.addEventListener('click', (e) => {
        const isLinkClickInsideSidebar = sidebar.contains(e.target.closest('a'));
        if (dashboardContainer.classList.contains('sidebar-mobile-open') && ((!sidebar.contains(e.target) && !mobileToggleBtn.contains(e.target)) || isLinkClickInsideSidebar)) {
          dashboardContainer.classList.remove('sidebar-mobile-open');
        }
      });
    }
  </script>
</body>
</html>